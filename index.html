<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sao Äá» TH&THCS PhÆ°á»›c An</title>
    <style>
        :root {
            --p: #0056b3; --s: #2e7d32; --a: #d32f2f; --bg: #e3f2fd;
        }

        /* GIAO DIá»†N CHUNG */
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding: 10px; padding-bottom: 80px; }
        body::before {
            content: "ğŸ“ TrÆ°á»ng TH&THCS PhÆ°á»›c An"; display: block; font-size: 0.75rem; font-weight: bold;
            color: var(--p); padding: 5px 10px; background: rgba(255, 255, 255, 0.8);
            border-radius: 0 0 10px 0; position: fixed; top: 0; left: 0; z-index: 100;
        }

        .header { background: var(--p); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; max-width: 1100px; margin: 0 auto; }

        /* Báº¢NG ÄIá»‚M */
        .table-section { flex: 1; min-width: 320px; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; }
        th { padding: 10px; border-bottom: 2px solid #eee; color: #666; font-size: 0.8rem; }
        td { padding: 12px 5px; text-align: center; border-bottom: 1px solid #f9f9f9; font-weight: bold; }
        .lop-row { cursor: pointer; transition: 0.2s; }
        .dang-chon { background: #fff9c4 !important; outline: 2px solid #ffd600; }

        /* PANEL CHáº¤M ÄIá»‚M & AI */
        .panel-section { flex: 1.2; min-width: 320px; background: white; padding: 20px; border-radius: 15px; display: none; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border-top: 5px solid var(--p); }
        .ai-box { background: #f0f7ff; border: 1px dashed var(--p); padding: 10px; border-radius: 10px; margin-bottom: 15px; }
        .ai-tag { background: var(--p); color: white; padding: 2px 8px; border-radius: 5px; font-size: 0.7rem; font-weight: bold; }

        .group-title { background: #f8f9fa; color: var(--p); padding: 8px; font-weight: bold; border-radius: 5px; margin: 15px 0 5px 0; font-size: 0.8rem; border-left: 4px solid var(--p); }
        .loi-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #f1f1f1; }
        .loi-item span { flex: 1; font-size: 0.85rem; }
        input[type=number] { width: 45px; padding: 8px; border: 1px solid #ddd; border-radius: 8px; text-align: center; font-weight: bold; }

        /* NÃšT Báº¤M */
        .btn { width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .btn-apply { background: var(--p); color: white; font-size: 1rem; }
        .btn-zalo { background: white; color: var(--p); border: 2px solid var(--p); }

        /* TRANG TRÃ */
        .decoration { position: fixed; bottom: 0; left: 0; right: 0; height: 60px; pointer-events: none; display: flex; align-items: flex-end; justify-content: space-between; padding: 0 20px; z-index: 1; }
        .footer-credit { text-align: center; font-size: 0.7rem; color: #78909c; padding: 10px; position: relative; z-index: 2; margin-top: 20px; }

        @media (max-width: 600px) { .container { flex-direction: column; } .panel-section { width: auto; } }
    </style>
</head>
<body>

<div class="header">
    <div style="font-size: 2rem;">ğŸ«</div>
    <h1>Há»‡ Thá»‘ng Sao Äá» PhÆ°á»›c An</h1>
    <div style="font-size: 0.8rem; opacity: 0.9;">Dá»¯ liá»‡u thi Ä‘ua há»c sinh THCS</div>
</div>

<div class="container">
    <div class="table-section">
        <table>
            <thead><tr><th>Háº¡ng</th><th>Lá»›p</th><th>Äiá»ƒm</th></tr></thead>
            <tbody id="body-bang">
                <script>
                    const lops = ['6A','6B','6C','7A','7B','7C','8A','8B','8C','9A','9B'];
                    lops.forEach(l => {
                        document.write(`<tr class="lop-row" data-lop="${l}" onclick="chonLop(this)"><td class="xh"></td><td>${l}</td><td class="tong">100</td></tr>`);
                    });
                </script>
            </tbody>
        </table>
        <button class="btn btn-zalo" onclick="xuatBaoCao()">ğŸ“‹ Sao chÃ©p bÃ¡o cÃ¡o Zalo</button>
        <button class="btn" style="background:none; color:#999; font-size:0.7rem;" onclick="resetDiem()">ğŸ”„ LÃ m má»›i tuáº§n má»›i</button>
    </div>

    <div id="panel" class="panel-section">
        <div class="ai-box">
            <span class="ai-tag">AI NHáº¬N XÃ‰T</span>
            <p id="ai-nhan-xet" style="font-size: 0.85rem; color: #333; margin: 8px 0 0 0; line-height: 1.4;">HÃ£y chá»n má»™t lá»›p Ä‘á»ƒ xem Ä‘Ã¡nh giÃ¡ thÃ´ng minh...</p>
        </div>

        <h2 id="tenlop" style="text-align:center; color: var(--p); margin: 10px 0;">Lá»›p</h2>
        
        <div id="form-nhap">
            <div class="group-title">ğŸ‘” TÃC PHONG ( -5Ä‘ )</div>
            <div class="loi-item"><span>KhÄƒn quÃ ng / Huy hiá»‡u</span><input type="number" id="l1" data-d="-5"></div>
            <div class="loi-item"><span>Bá» Ã¡o vÃ o quáº§n / TÃ¡c phong</span><input type="number" id="l2" data-d="-5"></div>
            <div class="loi-item"><span>Äá»“ng phá»¥c / GiÃ y dÃ©p</span><input type="number" id="l3" data-d="-5"></div>
            
            <div class="group-title">â° CHUYÃŠN Cáº¦N & TRáº¬T Tá»°</div>
            <div class="loi-item"><span>Äi trá»… ( -2Ä‘ )</span><input type="number" id="l4" data-d="-2"></div>
            <div class="loi-item"><span>Váº¯ng khÃ´ng phÃ©p ( -5Ä‘ )</span><input type="number" id="l5" data-d="-5"></div>
            <div class="loi-item"><span>NÃ³i chuyá»‡n / Trá»‘n tiáº¿t ( -10Ä‘ )</span><input type="number" id="l6" data-d="-10"></div>

            <div class="group-title">ğŸŒŸ ÄIá»‚M THI ÄUA (Cá»˜NG)</div>
            <div class="loi-item"><span>Äiá»ƒm 10 há»c táº­p ( +10Ä‘ )</span><input type="number" id="l7" data-d="10"></div>
            <div class="loi-item"><span>Tiáº¿t há»c tá»‘t ( +10Ä‘ )</span><input type="number" id="l8" data-d="10"></div>
        </div>

        <button class="btn btn-apply" onclick="apDung()">Cáº¬P NHáº¬T & PHÃ‚N TÃCH AI</button>
    </div>
</div>

<div class="decoration">
    <div style="font-size: 40px;">ğŸŒ³ğŸŒ²</div>
    <div style="font-size: 50px;">ğŸ«</div>
    <div style="font-size: 40px;">ğŸŒ²ğŸŒ³</div>
</div>

<div class="footer-credit">
    By <b>truongkycaonguyen</b> | TH&THCS PhÆ°á»›c An
</div>

<script>
let lopDangChon = null;
let dataLoi = {};

window.onload = () => { loadData(); xepHang(); };

function chonLop(row) {
    document.querySelectorAll(".lop-row").forEach(r => r.classList.remove("dang-chon"));
    row.classList.add("dang-chon");
    lopDangChon = row;
    document.getElementById("panel").style.display = "block";
    document.getElementById("tenlop").innerText = "Äang xem: " + row.dataset.lop;

    const saved = dataLoi[row.dataset.lop] || {};
    document.querySelectorAll("#form-nhap input").forEach(i => i.value = saved[i.id] || 0);
    capNhatAI();
    if(window.innerWidth < 600) document.getElementById("panel").scrollIntoView({behavior: "smooth"});
}

function apDung() {
    if(!lopDangChon) return;
    let tongBienDong = 0;
    let tempLoi = {};
    document.querySelectorAll("#form-nhap input").forEach(i => {
        let val = Number(i.value) || 0;
        tongBienDong += (val * Number(i.dataset.d));
        tempLoi[i.id] = val;
    });
    dataLoi[lopDangChon.dataset.lop] = tempLoi;
    let total = 100 + tongBienDong;
    lopDangChon.querySelector(".tong").innerText = (total < 0) ? 0 : total;
    lopDangChon.dataset.tong = (total < 0) ? 0 : total;
    
    capNhatAI();
    xepHang(); 
    saveData();
    
    const btn = document.querySelector(".btn-apply");
    btn.innerText = "ÄÃƒ PHÃ‚N TÃCH âœ”ï¸";
    setTimeout(() => btn.innerText = "Cáº¬P NHáº¬T & PHÃ‚N TÃCH AI", 1000);
}

function capNhatAI() {
    const diem = Number(lopDangChon.dataset.tong) || 100;
    const loi = dataLoi[lopDangChon.dataset.lop] || {};
    let nx = "";

    if (diem >= 100) nx = "ğŸŒŸ Lá»›p duy trÃ¬ phong Ä‘á»™ xuáº¥t sáº¯c. KhÃ´ng cÃ³ lá»—i vi pháº¡m. Cáº§n tiáº¿p tá»¥c phÃ¡t huy!";
    else if (diem >= 90) nx = "âœ… Ã thá»©c tá»‘t. Tuy nhiÃªn cáº§n nháº¯c nhá»Ÿ vÃ i cÃ¡ nhÃ¢n vá» lá»—i tÃ¡c phong Ä‘á»ƒ Ä‘áº¡t Ä‘iá»ƒm tuyá»‡t Ä‘á»‘i.";
    else if (diem >= 80) nx = "âš ï¸ Lá»›p cÃ³ dáº¥u hiá»‡u lÆ¡ lÃ . Lá»—i táº­p trung nhiá»u á»Ÿ chuyÃªn cáº§n. GVCN cáº§n Ä‘Ã´n Ä‘á»‘c hÆ¡n.";
    else if (diem >= 60) nx = "âŒ TÃ¬nh tráº¡ng thi Ä‘ua á»Ÿ má»©c trung bÃ¬nh. Nhiá»u vi pháº¡m vá» ká»· luáº­t vÃ  tráº­t tá»±. Cáº§n há»p lá»›p cháº¥n chá»‰nh ngay.";
    else nx = "ğŸš© BÃO Äá»˜NG: Vi pháº¡m nghiÃªm trá»ng há»‡ thá»‘ng ná»™i quy. Äá» nghá»‹ cáº¥m tÃºc vÃ  háº¡ báº­c thi Ä‘ua tuáº§n nÃ y.";

    if (loi.l4 > 2) nx += " Äáº·c biá»‡t, tÃ¬nh tráº¡ng Ä‘i trá»… Ä‘ang diá»…n ra khÃ¡ phá»• biáº¿n.";
    if (loi.l7 > 3) nx += " Äiá»ƒm sÃ¡ng lÃ  lá»›p cÃ³ nhiá»u hoa Ä‘iá»ƒm 10 bÃ¹ Ä‘áº¯p láº¡i lá»—i vi pháº¡m.";

    document.getElementById("ai-nhan-xet").innerText = nx;
}

function xepHang() {
    let rows = Array.from(document.querySelectorAll(".lop-row"));
    rows.sort((a,b) => (Number(b.dataset.tong) || 100) - (Number(a.dataset.tong) || 100));
    let container = document.getElementById("body-bang");
    rows.forEach((r, i) => {
        let h = i + 1;
        r.querySelector(".xh").innerText = (h==1)?"ğŸ¥‡":(h==2)?"ğŸ¥ˆ":(h==3)?"ğŸ¥‰":h;
        container.appendChild(r);
    });
}

function saveData() {
    localStorage.setItem('pa_diem', JSON.stringify(Array.from(document.querySelectorAll(".lop-row")).map(r => ({l: r.dataset.lop, d: r.querySelector(".tong").innerText}))));
    localStorage.setItem('pa_loi', JSON.stringify(dataLoi));
}

function loadData() {
    const d = JSON.parse(localStorage.getItem('pa_diem'));
    const l = JSON.parse(localStorage.getItem('pa_loi'));
    if (d) d.forEach(item => {
        let r = document.querySelector(`.lop-row[data-lop="${item.l}"]`);
        if(r) { r.querySelector(".tong").innerText = item.d; r.dataset.tong = item.d; }
    });
    if (l) dataLoi = l;
}

function resetDiem() {
    if(confirm("Báº¡n muá»‘n reset toÃ n bá»™ dá»¯ liá»‡u PhÆ°á»›c An tuáº§n nÃ y?")) {
        localStorage.clear(); location.reload();
    }
}

function xuatBaoCao() {
    let t = "ğŸ“‹ BÃO CÃO THI ÄUA PHÆ¯á»šC AN\n--------------------------\n";
    document.querySelectorAll(".lop-row").forEach(r => {
        t += `${r.querySelector(".xh").innerText}. Lá»›p ${r.dataset.lop}: ${r.querySelector(".tong").innerText}Ä‘\n`;
    });
    t += "\nBy truongkycaonguyen";
    navigator.clipboard.writeText(t).then(() => alert("ÄÃ£ copy bÃ¡o cÃ¡o!"));
}
</script>
</body>
</html>
