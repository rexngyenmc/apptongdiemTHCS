<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>S·ªï Tay Sao ƒê·ªè THCS</title>
    <style>
        :root {
            --school-blue: #0056b3;
            --leaf-green: #2e7d32;
            --sky-blue: #e3f2fd;
            --accent: #ff9800;
        }

        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: var(--sky-blue); 
            margin: 0; padding: 10px;
            padding-bottom: 100px; /* Ch·ª´a ch·ªó cho h√†ng c√¢y ·ªü d∆∞·ªõi */
        }

        /* Header phong c√°ch b·∫£ng hi·ªáu tr∆∞·ªùng */
        .school-header {
            background: var(--school-blue);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; max-width: 1000px; margin: 0 auto; }

        /* B·∫£ng x·∫øp h·∫°ng tr·∫Øng tinh kh√¥i */
        .table-section { 
            flex: 1; min-width: 320px; background: white; 
            padding: 15px; border-radius: 15px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        table { width: 100%; border-collapse: collapse; }
        th { color: #666; font-size: 0.8rem; text-transform: uppercase; padding: 10px; border-bottom: 2px solid #eee; }
        td { padding: 12px 5px; text-align: center; border-bottom: 1px solid #f9f9f9; font-weight: bold; }
        
        .lop-row { cursor: pointer; border-radius: 8px; }
        .dang-chon { background: #fffde7 !important; outline: 2px solid var(--accent); }

        /* Panel ch·∫•m ƒëi·ªÉm */
        .panel-section { 
            flex: 1.2; min-width: 320px; background: white; 
            padding: 20px; border-radius: 15px; 
            display: none; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-top: 5px solid var(--school-blue);
            z-index: 10;
        }

        .group-title { 
            background: #f0f4f8; color: var(--school-blue);
            padding: 8px; font-weight: bold; border-radius: 5px;
            margin: 15px 0 10px 0; font-size: 0.8rem;
        }

        .loi-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #f1f1f1; }
        .loi-item span { flex: 1; font-size: 0.9rem; }
        .loi-item b { width: 40px; text-align: right; color: #d32f2f; margin-right: 10px; }
        .loi-item b.plus { color: #2e7d32; }
        input[type=number] { width: 45px; padding: 8px; border: 1px solid #ddd; border-radius: 8px; text-align: center; font-weight: bold; }

        /* N√∫t b·∫•m */
        .btn { width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-apply { background: var(--school-blue); color: white; font-size: 1rem; }
        .btn-zalo { background: white; color: var(--school-blue); border: 2px solid var(--school-blue); }

        /* TRANG TR√ç G√ìC D∆Ø·ªöI */
        .decoration {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            height: 80px;
            pointer-events: none; /* Kh√¥ng l√†m v∆∞·ªõng khi ch·∫°m */
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1;
        }
        .school-icon { font-size: 50px; filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.1)); }
        .trees { font-size: 40px; }

        @media (max-width: 600px) {
            .container { flex-direction: column; }
            .panel-section { position: relative; width: auto; }
        }
    </style>
</head>
<body>

<div class="school-header">
    <div style="font-size: 2rem;">üè´</div>
    <h1>H·ªá Th·ªëng T·ªïng K·∫øt Sao ƒê·ªè</h1>
    <div style="font-size: 0.8rem; opacity: 0.8;">NƒÉm h·ªçc 2025 - 2026</div>
</div>

<div class="container">
    <div class="table-section">
        <table>
            <thead><tr><th>H·∫°ng</th><th>L·ªõp</th><th>ƒêi·ªÉm</th></tr></thead>
            <tbody id="body-bang">
                <script>
                    const lops = ['6A','6B','6C','7A','7B','7C','8A','8B','8C','9A','9B'];
                    lops.forEach(l => {
                        document.write(`<tr class="lop-row" data-lop="${l}" onclick="chonLop(this)"><td class="xh"></td><td>${l}</td><td class="tong">100</td></tr>`);
                    });
                </script>
            </tbody>
        </table>
        <button class="btn btn-zalo" onclick="xuatBaoCao()">üìã Copy B√°o C√°o Zalo</button>
        <button class="btn" style="background:none; color:#999; text-decoration:underline;" onclick="resetDiem()">X√≥a d·ªØ li·ªáu tu·∫ßn c≈©</button>
    </div>

    <div id="panel" class="panel-section">
        <h2 id="tenlop" style="text-align:center; color: var(--school-blue);">L·ªõp</h2>
        <div id="form-nhap">
            <div class="group-title">üëî T√ÅC PHONG</div>
            <div class="loi-item"><span>KhƒÉn qu√†ng/Huy hi·ªáu</span><b>-5</b><input type="number" id="l1" data-d="-5"></div>
            <div class="loi-item"><span>T√°c phong/√Åo kho√°c</span><b>-5</b><input type="number" id="l2" data-d="-5"></div>
            <div class="loi-item"><span>ƒê·ªìng ph·ª•c/Gi√†y d√©p</span><b>-5</b><input type="number" id="l3" data-d="-5"></div>
            
            <div class="group-title">üìö H·ªåC T·∫¨P & K·ª∂ LU·∫¨T</div>
            <div class="loi-item"><span>ƒêi tr·ªÖ/V·∫Øng/Tr·ªën ti·∫øt</span><b>-5</b><input type="number" id="l4" data-d="-5"></div>
            <div class="loi-item"><span>N√≥i chuy·ªán/ƒêi·ªán tho·∫°i</span><b>-5</b><input type="number" id="l5" data-d="-5"></div>
            <div class="loi-item"><span>ƒêi·ªÉm 10 (C·ªông)</span><b class="plus">+10</b><input type="number" id="l6" data-d="10"></div>
            
            <div class="group-title">üßπ T·∫¨P TH·ªÇ</div>
            <div class="loi-item"><span>V·ªá sinh/B·ªè r√°c sai</span><b>-20</b><input type="number" id="l7" data-d="-20"></div>
            <div class="loi-item"><span>Ch√†o c·ªù/TD gi·ªØa gi·ªù</span><b>-20</b><input type="number" id="l8" data-d="-20"></div>
        </div>
        <button class="btn btn-apply" onclick="apDung()">L∆ØU K·∫æT QU·∫¢</button>
    </div>
</div>

<div class="decoration">
    <div class="trees">üå≥üå≤üå≥</div>
    <div class="school-icon">üè´</div>
    <div class="trees">üå≤üå≥</div>
</div>

<script>
let lopDangChon = null;
let dataLoi = {};

window.onload = () => { loadData(); xepHang(); };

function chonLop(row) {
    document.querySelectorAll(".lop-row").forEach(r => r.classList.remove("dang-chon"));
    row.classList.add("dang-chon");
    lopDangChon = row;
    document.getElementById("panel").style.display = "block";
    document.getElementById("tenlop").innerText = "ƒêang ch·∫•m: " + row.dataset.lop;

    const saved = dataLoi[row.dataset.lop] || {};
    document.querySelectorAll("#form-nhap input").forEach(i => i.value = saved[i.id] || 0);
    if(window.innerWidth < 600) document.getElementById("panel").scrollIntoView({behavior: "smooth"});
}

function apDung() {
    if(!lopDangChon) return;
    let tong = 0;
    let tempLoi = {};
    document.querySelectorAll("#form-nhap input").forEach(i => {
        let val = Number(i.value) || 0;
        tong += (val * Number(i.dataset.d));
        tempLoi[i.id] = val;
    });
    dataLoi[lopDangChon.dataset.lop] = tempLoi;
    let total = 100 + tong;
    lopDangChon.querySelector(".tong").innerText = (total < 0) ? 0 : total;
    lopDangChon.dataset.tong = (total < 0) ? 0 : total;
    xepHang(); saveData();
    alert("ƒê√£ c·∫≠p nh·∫≠t!");
}

function xepHang() {
    let rows = Array.from(document.querySelectorAll(".lop-row"));
    rows.sort((a,b) => (Number(b.dataset.tong) || 100) - (Number(a.dataset.tong) || 100));
    let container = document.getElementById("body-bang");
    rows.forEach((r, i) => {
        let h = i + 1;
        r.querySelector(".xh").innerText = (h==1)?"ü•á":(h==2)?"ü•à":(h==3)?"ü•â":h;
        container.appendChild(r);
    });
}

function saveData() {
    localStorage.setItem('sd_diem_final', JSON.stringify(Array.from(document.querySelectorAll(".lop-row")).map(r => ({l: r.dataset.lop, d: r.querySelector(".tong").innerText}))));
    localStorage.setItem('sd_loi_final', JSON.stringify(dataLoi));
}

function loadData() {
    const d = JSON.parse(localStorage.getItem('sd_diem_final'));
    const l = JSON.parse(localStorage.getItem('sd_loi_final'));
    if (d) d.forEach(item => {
        let r = document.querySelector(`.lop-row[data-lop="${item.l}"]`);
        if(r) { r.querySelector(".tong").innerText = item.d; r.dataset.tong = item.d; }
    });
    if (l) dataLoi = l;
}

function resetDiem() {
    if(confirm("B·∫°n mu·ªën reset ƒëi·ªÉm tu·∫ßn n√†y?")) {
        localStorage.clear(); location.reload();
    }
}

function xuatBaoCao() {
    let t = "üìã B√ÅO C√ÅO THI ƒêUA\n";
    document.querySelectorAll(".lop-row").forEach(r => {
        t += `${r.querySelector(".xh").innerText}. L·ªõp ${r.dataset.lop}: ${r.querySelector(".tong").innerText}ƒë\n`;
    });
    navigator.clipboard.writeText(t).then(() => alert("ƒê√£ copy b√°o c√°o!"));
}
</script>
</body>
</html>
