<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SAO ƒê·ªé PH∆Ø·ªöC AN - 2026</title>
    <style>
        :root { --p: #4361ee; --s: #2ec4b6; --a: #e71d36; --bg: #f8f9fa; --txt: #2b2d42; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--txt); margin: 0; padding: 15px; }
        
        .header { text-align: center; padding: 20px 0; background: linear-gradient(135deg, var(--p), #7209b7); color: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 10px 20px rgba(67, 97, 238, 0.2); }
        .header h2 { margin: 0; letter-spacing: 1px; }

        /* Grid l·ªõp ƒë·∫πp */
        .grid-lops { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 12px; margin-bottom: 20px; }
        .lop-card { background: white; padding: 15px 10px; border-radius: 15px; text-align: center; border: 2px solid transparent; transition: 0.3s; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .lop-card.active { border-color: var(--p); background: #edf2ff; transform: translateY(-5px); }
        .lop-card b { display: block; font-size: 1.2rem; margin-bottom: 5px; }
        .lop-card span { font-size: 0.9rem; font-weight: bold; color: var(--p); }

        /* V√πng ch·∫•m ƒëi·ªÉm */
        .main-card { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); display: none; }
        .sticky-top { position: sticky; top: 10px; background: white; z-index: 100; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        
        input[type="text"] { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #e0e0e0; font-size: 1rem; box-sizing: border-box; transition: 0.3s; margin-top: 10px; }
        input[type="text"]:focus { border-color: var(--p); outline: none; }

        /* B·∫£ng l·ªói ƒë·∫ßy ƒë·ªß */
        .scroll-loi { max-height: 400px; overflow-y: auto; margin: 15px 0; padding-right: 5px; }
        .nhom-title { font-size: 0.75rem; font-weight: bold; color: #8d99ae; text-transform: uppercase; margin: 20px 0 10px 0; border-left: 4px solid var(--p); padding-left: 8px; }
        
        .loi-item { display: flex; align-items: center; background: #fdfdfd; padding: 12px; border-radius: 12px; margin-bottom: 8px; border: 1px solid #f0f0f0; cursor: pointer; }
        .loi-item input { width: 22px; height: 22px; margin-right: 15px; accent-color: var(--p); pointer-events: none; }
        .loi-item .ten { flex: 1; font-size: 0.95rem; }
        .loi-item .diem { font-weight: bold; font-size: 0.9rem; }
        .diem.tru { color: var(--a); } .diem.cong { color: var(--s); }

        .btn-xacnhan { width: 100%; padding: 18px; border-radius: 15px; border: none; background: var(--p); color: white; font-size: 1.1rem; font-weight: bold; cursor: pointer; box-shadow: 0 8px 15px rgba(67, 97, 238, 0.3); }
        
        .log-box { margin-top: 20px; background: #fffde7; border-radius: 12px; padding: 15px; border: 1px dashed #fbc02d; font-size: 0.85rem; }
        .log-item { border-bottom: 1px solid #eee; padding: 5px 0; }
    </style>
</head>
<body>

<div class="header">
    <h2>üåü SAO ƒê·ªé PH∆Ø·ªöC AN</h2>
</div>

<div class="grid-lops" id="ds-lop"></div>

<div class="main-card" id="vung-cham">
    <div class="sticky-top">
        <h3 id="dang-cham-lop" style="margin:0; color:var(--p)">L·ªõp --</h3>
        <input type="text" id="input-ten" placeholder="üë§ Nh·∫≠p t√™n HS (c√°ch nhau d·∫•u ph·∫©y)...">
    </div>

    <div class="scroll-loi" id="bang-loi">
        <div class="nhom-title">1. T√°c phong (Tr·ª´ 5ƒë)</div>
        <div class="loi-item" onclick="toggleCK('m1')"><input type="checkbox" id="m1" data-d="-5" data-n="KhƒÉn qu√†ng"> <span class="ten">Kh√¥ng KhƒÉn qu√†ng/Huy hi·ªáu</span> <span class="diem tru">-5</span></div>
        <div class="loi-item" onclick="toggleCK('m2')"><input type="checkbox" id="m2" data-d="-5" data-n="T√°c phong"> <span class="ten">Kh√¥ng b·ªè √°o v√†o qu·∫ßn</span> <span class="diem tru">-5</span></div>
        <div class="loi-item" onclick="toggleCK('m3')"><input type="checkbox" id="m3" data-d="-5" data-n="√Åo kho√°c"> <span class="ten">M·∫∑c √°o kho√°c sai quy ƒë·ªãnh</span> <span class="diem tru">-5</span></div>
        <div class="loi-item" onclick="toggleCK('m4')"><input type="checkbox" id="m4" data-d="-5" data-n="Ch√¢n tr·∫ßn"> <span class="ten">ƒêi ch√¢n tr·∫ßn ra s√¢n/WC</span> <span class="diem tru">-5</span></div>
        
        <div class="nhom-title">2. K·ª∑ lu·∫≠t & ƒê·∫°o ƒë·ª©c</div>
        <div class="loi-item" onclick="toggleCK('m5')"><input type="checkbox" id="m5" data-d="-10" data-n="N√≥i t·ª•c"> <span class="ten">N√≥i t·ª•c, ch·ª≠i th·ªÅ</span> <span class="diem tru">-10</span></div>
        <div class="loi-item" onclick="toggleCK('m6')"><input type="checkbox" id="m6" data-d="-10" data-n="ƒê√°nh nhau"> <span class="ten">ƒê√°nh nhau</span> <span class="diem tru">-10</span></div>
        <div class="loi-item" onclick="toggleCK('m7')"><input type="checkbox" id="m7" data-d="-20" data-n="B·ªè r√°c"> <span class="ten">B·ªè r√°c kh√¥ng ƒë√∫ng n∆°i quy ƒë·ªãnh</span> <span class="diem tru">-20</span></div>
        <div class="loi-item" onclick="toggleCK('m8')"><input type="checkbox" id="m8" data-d="-30" data-n="Chui r√†o"> <span class="ten">Chui r√†o, ph√° h√†ng r√†o</span> <span class="diem tru">-30</span></div>
        
        <div class="nhom-title">3. Chuy√™n c·∫ßn & T·∫≠p th·ªÉ</div>
        <div class="loi-item" onclick="toggleCK('m9')"><input type="checkbox" id="m9" data-d="-2" data-n="ƒêi tr·ªÖ"> <span class="ten">H·ªçc sinh ƒëi tr·ªÖ</span> <span class="diem tru">-2</span></div>
        <div class="loi-item" onclick="toggleCK('m10')"><input type="checkbox" id="m10" data-d="-50" data-n="SH 15p" data-tp="L"> <span class="ten">L·ªõp kh√¥ng SH 15 ph√∫t (T√≠nh 1 l·∫ßn)</span> <span class="diem tru">-50</span></div>
        <div class="loi-item" onclick="toggleCK('m11')"><input type="checkbox" id="m11" data-d="-20" data-n="Qu·ªëc ca" data-tp="L"> <span class="ten">L·ªõp h√°t Qu·ªëc ca nh·ªè (T√≠nh 1 l·∫ßn)</span> <span class="diem tru">-20</span></div>

        <div class="nhom-title">4. H·ªçc t·∫≠p (Th∆∞·ªüng/Ph·∫°t)</div>
        <div class="loi-item" onclick="toggleCK('m12')"><input type="checkbox" id="m12" data-d="10" data-n="ƒêi·ªÉm 10"> <span class="ten">H·ªçc sinh ƒë·∫°t ƒëi·ªÉm 10</span> <span class="diem cong">+10</span></div>
        <div class="loi-item" onclick="toggleCK('m13')"><input type="checkbox" id="m13" data-d="10" data-n="Ti·∫øt A" data-tp="L"> <span class="ten">Ti·∫øt h·ªçc lo·∫°i A (T√≠nh 1 l·∫ßn)</span> <span class="diem cong">+10</span></div>
    </div>

    <button class="btn-xacnhan" onclick="luuDiem()">‚úÖ X√ÅC NH·∫¨N ƒê·ª¢T N√ÄY</button>
    <div class="log-box" id="nhat-ky"></div>
</div>

<script>
    const lops = ['6A','6B','6C','7A','7B','7C','8A','8B','8C','9A','9B'];
    let db = JSON.parse(localStorage.getItem('pa_2026_final')) || {};
    let cur = "";

    function veLop() {
        let html = "";
        lops.forEach(l => {
            let diem = db[l] ? db[l].total : 100;
            html += `<div class="lop-card ${cur==l?'active':''}" onclick="chonLop('${l}')"><b>${l}</b><span>${diem}ƒë</span></div>`;
        });
        document.getElementById('ds-lop').innerHTML = html;
    }

    function toggleCK(id) { document.getElementById(id).checked = !document.getElementById(id).checked; }

    function chonLop(l) {
        cur = l; veLop();
        document.getElementById('vung-cham').style.display = "block";
        document.getElementById('dang-cham-lop').innerText = "ƒêang ch·∫•m: L·ªõp " + l;
        inLog();
    }

    function luuDiem() {
        const input = document.getElementById('input-ten').value.trim();
        const hs = input.split(/[,.;]+/).filter(x => x.trim().length > 0);
        const checks = Array.from(document.querySelectorAll('.ck-loi:checked, input[type="checkbox"]:checked'));

        if (checks.length === 0) return alert("Ch∆∞a ch·ªçn l·ªói!");
        // Ki·ªÉm tra xem c√≥ l·ªói c√° nh√¢n kh√¥ng, n·∫øu c√≥ th√¨ ph·∫£i nh·∫≠p t√™n
        const coLoiCaNhan = checks.some(c => c.dataset.tp !== "L");
        if (coLoiCaNhan && hs.length === 0) return alert("Vui l√≤ng nh·∫≠p t√™n h·ªçc sinh!");

        if (!db[cur]) db[cur] = { total: 100, logs: [] };

        let dotDiem = 0;
        let moTa = [];

        checks.forEach(c => {
            let diemLoi = parseInt(c.dataset.d);
            let soLuong = (c.dataset.tp === "L") ? 1 : hs.length;
            dotDiem += (diemLoi * soLuong);
            moTa.push(`${c.dataset.n}(${soLuong})`);
        });

        db[cur].total += dotDiem;
        db[cur].logs.unshift(`${new Date().toLocaleTimeString('vi-VN',{hour:'2-digit',minute:'2-digit'})}: ${dotDiem}ƒë - ${input || 'C·∫£ l·ªõp'} [${moTa.join(', ')}]`);

        // X√≥a s·∫°ch ƒë·ªÉ qua ƒë·ª£t sau
        document.getElementById('input-ten').value = "";
        checks.forEach(c => c.checked = false);

        localStorage.setItem('pa_2026_final', JSON.stringify(db));
        veLop(); inLog(); alert("ƒê√£ l∆∞u ƒë·ª£t n√†y!");
    }

    function inLog() {
        const box = document.getElementById('nhat-ky');
        if (!db[cur] || db[cur].logs.length === 0) { box.innerHTML = "<i>Ch∆∞a c√≥ d·ªØ li·ªáu.</i>"; return; }
        box.innerHTML = "<b>L·ªãch s·ª≠ c·ªông d·ªìn:</b><br>" + db[cur].logs.map(i => `<div class="log-item">${i}</div>`).join("");
    }

    veLop();
</script>
</body>
</html>
