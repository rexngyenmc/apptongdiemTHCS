<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sao ƒê·ªè THCS 2025-2026</title>
    <style>
        :root { --p: #1976d2; --a: #d32f2f; --s: #2e7d32; --bg: #f0f2f5; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 10px; font-size: 14px; }
        h1 { text-align: center; color: var(--p); text-transform: uppercase; font-size: 1.2rem; margin: 10px 0; }
        
        .container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; max-width: 1200px; margin: 0 auto; }
        
        /* B·∫£ng x·∫øp h·∫°ng */
        .table-section { flex: 1; min-width: 320px; background: white; padding: 10px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; }
        th, td { border-bottom: 1px solid #eee; padding: 10px 5px; text-align: center; }
        th { background: var(--p); color: white; }
        .lop-row { cursor: pointer; }
        .dang-chon { background: #fff9c4 !important; outline: 2px solid #ffd600; }

        /* B·∫£ng nh·∫≠p l·ªói */
        .panel-section { flex: 1.2; min-width: 320px; background: white; padding: 15px; border-radius: 10px; display: none; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .group-title { background: #eee; padding: 5px 10px; font-weight: bold; margin-top: 15px; border-left: 4px solid var(--p); }
        .loi-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #f5f5f5; }
        .loi-item span { flex: 1; padding-right: 10px; font-size: 13px; }
        .loi-item b { color: var(--a); width: 40px; text-align: right; margin-right: 10px; }
        .loi-item b.plus { color: var(--s); }
        input[type=number] { width: 45px; padding: 5px; border: 1px solid #ccc; border-radius: 4px; text-align: center; }

        /* N√∫t b·∫•m */
        .btn { width: 100%; padding: 12px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; color: white; }
        .btn-apply { background: var(--s); font-size: 1rem; position: sticky; bottom: 10px; z-index: 10; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        .btn-zalo { background: var(--p); }
        .btn-reset { background: #757575; font-size: 0.8rem; }
    </style>
</head>
<body>

<h1>Bi·ªÉu ƒëi·ªÉm thi ƒëua 2025-2026</h1>

<div class="container">
    <div class="table-section">
        <table>
            <thead><tr><th>H·∫°ng</th><th>L·ªõp</th><th>ƒêi·ªÉm</th></tr></thead>
            <tbody id="body-bang">
                <script>
                    const lops = ['6A','6B','6C','7A','7B','7C','8A','8B','8C','9A','9B'];
                    lops.forEach(l => {
                        document.write(`<tr class="lop-row" data-lop="${l}" onclick="chonLop(this)"><td class="xh"></td><td>${l}</td><td class="tong">100</td></tr>`);
                    });
                </script>
            </tbody>
        </table>
        <button class="btn btn-zalo" onclick="xuatBaoCao()">üìã Sao ch√©p b√°o c√°o Zalo</button>
        <button class="btn btn-reset" onclick="resetDiem()">üîÑ Reset tu·∫ßn m·ªõi</button>
    </div>

    <div id="panel" class="panel-section">
        <h2 id="tenlop" style="text-align:center; color: var(--a); margin:0;">L·ªõp</h2>
        <p id="diem-hien-tai" style="text-align:center; font-weight:bold;">ƒêi·ªÉm: 100</p>
        
        <div id="form-nhap">
            <div class="group-title">1. T√ÅC PHONG & ƒê·∫†O ƒê·ª®C</div>
            <div class="loi-item"><span>KhƒÉn qu√†ng/Huy hi·ªáu</span><b>-5</b><input type="number" id="l1" data-d="-5"></div>
            <div class="loi-item"><span>Kh√¥ng b·ªè √°o v√†o qu·∫ßn</span><b>-5</b><input type="number" id="l2" data-d="-5"></div>
            <div class="loi-item"><span>M·∫∑c √°o kho√°c sai quy ƒë·ªãnh</span><b>-5</b><input type="number" id="l3" data-d="-5"></div>
            <div class="loi-item"><span>ƒê·ªìng ph·ª•c/Gi√†y d√©p sai</span><b>-5</b><input type="number" id="l4" data-d="-5"></div>
            <div class="loi-item"><span>T√≥c d√†i (Nam)/Nhu·ªôm/Son</span><b>-5</b><input type="number" id="l5" data-d="-5"></div>
            <div class="loi-item"><span>N√≥i t·ª•c/Ch·ª≠i th·ªÅ/ƒê√°nh nhau</span><b>-10</b><input type="number" id="l6" data-d="-10"></div>
            <div class="loi-item"><span>S·ª≠ d·ª•ng ƒëi·ªán tho·∫°i sai quy ƒë·ªãnh</span><b>-5</b><input type="number" id="l7" data-d="-5"></div>
            <div class="loi-item"><span>Ch·ªëng ƒë·ªëi Sao ƒë·ªè</span><b>-10</b><input type="number" id="l8" data-d="-10"></div>

            <div class="group-title">2. CHUY√äN C·∫¶N & TR·∫¨T T·ª∞</div>
            <div class="loi-item"><span>ƒêi tr·ªÖ</span><b>-2</b><input type="number" id="l9" data-d="-2"></div>
            <div class="loi-item"><span>V·∫Øng kh√¥ng ph√©p</span><b>-5</b><input type="number" id="l10" data-d="-5"></div>
            <div class="loi-item"><span>Tr·ªën ti·∫øt</span><b>-10</b><input type="number" id="l11" data-d="-10"></div>
            <div class="loi-item"><span>N√≥i chuy·ªán ri√™ng</span><b>-5</b><input type="number" id="l12" data-d="-5"></div>

            <div class="group-title">3. H·ªåC T·∫¨P (C·ªòNG/TR·ª™)</div>
            <div class="loi-item"><span>Kh√¥ng thu·ªôc b√†i/L√†m BT</span><b>-10</b><input type="number" id="l13" data-d="-10"></div>
            <div class="loi-item"><span>ƒêi·ªÉm 0, 1, 2, 3</span><b>-10</b><input type="number" id="l14" data-d="-10"></div>
            <div class="loi-item"><span>ƒêi·ªÉm 4</span><b>-5</b><input type="number" id="l15" data-d="-5"></div>
            <div class="loi-item"><span>ƒêi·ªÉm 7</span><b class="plus">+5</b><input type="number" id="l16" data-d="5"></div>
            <div class="loi-item"><span>ƒêi·ªÉm 8, 9</span><b class="plus">+9</b><input type="number" id="l17" data-d="9"></div>
            <div class="loi-item"><span>ƒêi·ªÉm 10</span><b class="plus">+10</b><input type="number" id="l18" data-d="10"></div>
            <div class="loi-item"><span>Ti·∫øt A/B (C·ªông)</span><b class="plus">+10/5</b><input type="number" id="l19" data-d="10"></div>
            <div class="loi-item"><span>Ti·∫øt C/D (Tr·ª´)</span><b>-5/10</b><input type="number" id="l20" data-d="-5"></div>

            <div class="group-title">4. T·∫¨P TH·ªÇ & PHONG TR√ÄO</div>
            <div class="loi-item"><span>Kh√¥ng SH 15 ph√∫t/TD gi·ªØa gi·ªù</span><b>-50</b><input type="number" id="l21" data-d="-50"></div>
            <div class="loi-item"><span>Ch√†o c·ªù tr·ªÖ/M·∫•t tr·∫≠t t·ª±</span><b>-20</b><input type="number" id="l22" data-d="-20"></div>
            <div class="loi-item"><span>Kh√¥ng h√°t Qu·ªëc ca/ƒê·ªôi ca</span><b>-20</b><input type="number" id="l23" data-d="-20"></div>
            <div class="loi-item"><span>B·ªè r√°c sai quy ƒë·ªãnh</span><b>-20</b><input type="number" id="l24" data-d="-20"></div>
            <div class="loi-item"><span>M·∫•t s·ªï ƒë·∫ßu b√†i</span><b>-50</b><input type="number" id="l25" data-d="-50"></div>
            <div class="loi-item"><span>Phong tr√†o (Nh·∫•t/Nh√¨/Ba)</span><b class="plus">+50</b><input type="number" id="l26" data-d="50"></div>
        </div>

        <button class="btn btn-apply" onclick="apDung()">C·∫¨P NH·∫¨T ƒêI·ªÇM L·ªöP</button>
    </div>
</div>

<script>
let lopDangChon = null;
let dataLoi = {};

window.onload = () => { loadData(); xepHang(); };

function chonLop(row) {
    document.querySelectorAll(".lop-row").forEach(r => r.classList.remove("dang-chon"));
    row.classList.add("dang-chon");
    lopDangChon = row;
    const tenLop = row.dataset.lop;
    
    document.getElementById("panel").style.display = "block";
    document.getElementById("tenlop").innerText = "L·ªõp " + tenLop;
    document.getElementById("diem-hien-tai").innerText = "ƒêi·ªÉm hi·ªán t·∫°i: " + row.querySelector(".tong").innerText;

    const saved = dataLoi[tenLop] || {};
    document.querySelectorAll(".input-loi, #form-nhap input").forEach(i => {
        i.value = saved[i.id] || 0;
    });
    if(window.innerWidth < 600) document.getElementById("panel").scrollIntoView({behavior: "smooth"});
}

function apDung() {
    if(!lopDangChon) return;
    const tenLop = lopDangChon.dataset.lop;
    let tongBienDong = 0;
    let tempLoi = {};

    document.querySelectorAll("#form-nhap input").forEach(i => {
        let soLan = Number(i.value) || 0;
        let diemHeSo = Number(i.dataset.d);
        tongBienDong += (soLan * diemHeSo);
        tempLoi[i.id] = soLan;
    });

    dataLoi[tenLop] = tempLoi;
    let diemMoi = 100 + tongBienDong;
    if (diemMoi < 0) diemMoi = 0;

    lopDangChon.querySelector(".tong").innerText = diemMoi;
    lopDangChon.dataset.tong = diemMoi;
    document.getElementById("diem-hien-tai").innerText = "ƒêi·ªÉm hi·ªán t·∫°i: " + diemMoi;

    xepHang();
    saveData();
    alert("ƒê√£ c·∫≠p nh·∫≠t ƒëi·ªÉm l·ªõp " + tenLop);
}

function xepHang() {
    let rows = Array.from(document.querySelectorAll(".lop-row"));
    rows.sort((a,b) => (Number(b.dataset.tong) || 100) - (Number(a.dataset.tong) || 100));
    let container = document.getElementById("body-bang");
    rows.forEach((r, i) => {
        let h = i + 1;
        r.querySelector(".xh").innerText = (h==1)?"1":(h==2)?"2":(h==3)?"3":h;
        container.appendChild(r);
    });
}

function saveData() {
    localStorage.setItem('sd_diem_2025', JSON.stringify(Array.from(document.querySelectorAll(".lop-row")).map(r => ({l: r.dataset.lop, d: r.querySelector(".tong").innerText}))));
    localStorage.setItem('sd_loi_2025', JSON.stringify(dataLoi));
}

function loadData() {
    const d = JSON.parse(localStorage.getItem('sd_diem_2025'));
    const l = JSON.parse(localStorage.getItem('sd_loi_2025'));
    if (d) d.forEach(item => {
        let r = document.querySelector(`.lop-row[data-lop="${item.l}"]`);
        if(r) { r.querySelector(".tong").innerText = item.d; r.dataset.tong = item.d; }
    });
    if (l) dataLoi = l;
}

function resetDiem() {
    if(confirm("Reset to√†n b·ªô ƒëi·ªÉm v·ªÅ 100 ƒë·ªÉ sang tu·∫ßn m·ªõi?")) {
        localStorage.clear();
        location.reload();
    }
}

function xuatBaoCao() {
    let t = "üìã B√ÅO C√ÅO THI ƒêUA\n";
    document.querySelectorAll(".lop-row").forEach(r => {
        t += `${r.querySelector(".xh").innerText}. L·ªõp ${r.dataset.lop}: ${r.querySelector(".tong").innerText}ƒë\n`;
    });
    navigator.clipboard.writeText(t).then(() => alert("ƒê√£ sao ch√©p!"));
}
</script>
</body>
</html>
