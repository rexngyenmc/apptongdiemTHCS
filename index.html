<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ph∆∞·ªõc An 2026 - H·ªá Th·ªëng ƒê·ªìng B·ªô</title>
    <style>
        :root { --blue: #1a73e8; --green: #34a853; --orange: #fbbc05; --red: #ea4335; --dark: #121212; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; background: #f0f2f5; color: #333; overflow-x: hidden; }
        
        /* M√†n h√¨nh */
        .screen { display: none; padding: 15px; max-width: 800px; margin: auto; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from {opacity:0} to {opacity:1} }
        
        /* Buttons */
        .btn-main { width: 100%; padding: 22px; border: none; border-radius: 15px; color: white; font-size: 1.2rem; font-weight: 800; cursor: pointer; margin-bottom: 15px; transition: 0.2s; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .btn-main:active { transform: scale(0.98); opacity: 0.9; }
        .bg-gv { background: var(--blue); } 
        .bg-sd { background: var(--green); } 
        .bg-bxh { background: var(--orange); color: black; }

        /* Search & Login Card */
        .card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 15px; }
        .inp-search { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid #ddd; font-size: 1rem; box-sizing: border-box; margin-bottom: 10px; outline: none; }
        .inp-search:focus { border-color: var(--blue); }
        .scroll-list { max-height: 250px; overflow-y: auto; border: 1px solid #eee; border-radius: 12px; background: #fff; }
        .user-item { padding: 15px; border-bottom: 1px solid #eee; cursor: pointer; text-align: left; font-weight: 500; }
        .user-item:hover { background: #f8f9fa; }
        .user-item.selected { background: var(--blue) !important; color: white !important; }

        /* Grid L·ªõp h√†ng ngang */
        .class-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 15px 0; }
        .btn-cl { padding: 15px 5px; border: 1px solid #ddd; border-radius: 12px; background: white; font-weight: bold; cursor: pointer; font-size: 0.9rem; }
        .btn-cl.active { background: var(--blue); color: white; border-color: var(--blue); }

        /* B·∫£ng L·ªãch S·ª≠ (LS) */
        .ls-table-container { overflow-x: auto; margin-top: 10px; border-radius: 10px; border: 1px solid #eee; }
        .ls-table { width: 100%; border-collapse: collapse; min-width: 450px; background: white; }
        .ls-table th, .ls-table td { padding: 12px; border: 1px solid #eee; text-align: left; font-size: 13px; }
        .ls-table th { background: #f1f3f4; font-weight: 700; }
        .btn-del { color: var(--red); cursor: pointer; font-weight: bold; border: none; background: none; }

        /* BXH Tr√¨nh chi·∫øu */
        #bxh-screen { background: radial-gradient(circle at top, #001f3f, #000); color: white; text-align: center; min-height: 100vh; padding: 40px 15px; }
        .rank-row { display: flex; align-items: center; background: rgba(255,255,255,0.08); margin: 12px auto; padding: 25px; border-radius: 20px; max-width: 900px; border: 1px solid rgba(255,255,255,0.1); }
        .rank-1 { background: linear-gradient(90deg, #ffd700, #ff8f00); color: black; font-weight: 900; transform: scale(1.05); }

        /* Th√¥ng b√°o ƒë·ªìng b·ªô */
        #sync-status { position: fixed; top: 10px; right: 10px; font-size: 10px; padding: 5px 10px; border-radius: 20px; background: #333; color: #0f0; display: none; z-index: 9999; }
    </style>
</head>
<body>

<div id="sync-status">ƒêang ƒë·ªìng b·ªô...</div>

<div id="home-screen" class="screen" style="display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh;">
    <h1 style="font-size: 2.2rem; margin-bottom: 5px; color: var(--blue);">PH∆Ø·ªöC AN 2026</h1>
    <p style="margin-bottom: 30px; color: #666; font-weight: 500;">H·ªá th·ªëng ch·∫•m ƒëi·ªÉm tr·ª±c tuy·∫øn</p>
    
    <button class="btn-main bg-gv" onclick="init('GV')">GI√ÅO VI√äN</button>
    <button class="btn-main bg-sd" onclick="init('SD')">SAO ƒê·ªé</button>
    <button class="btn-main bg-bxh" onclick="init('BXH')">B·∫¢NG V√ÄNG THI ƒêUA</button>
</div>

<div id="auth-screen" class="screen">
    <button onclick="goHome()" style="background:none; border:none; color:var(--blue); font-weight:bold; cursor:pointer; margin-bottom:15px;">‚Üê QUAY L·∫†I</button>
    <div class="card">
        <h2 id="auth-title" style="margin-top:0;">Ch·ªçn Ng∆∞·ªùi Ch·∫•m</h2>
        <input type="password" id="pin-input" class="inp-search" placeholder="Nh·∫≠p m√£ PIN..." style="display:none; text-align:center; letter-spacing: 5px;">
        <input type="text" id="user-search" class="inp-search" placeholder="G√µ ƒë·ªÉ t√¨m t√™n c·ªßa b·∫°n..." onkeyup="filterUser()">
        
        <div id="user-list" class="scroll-list">
            </div>
        
        <button class="btn-main bg-gv" style="margin-top:20px; padding:15px;" onclick="verifyUser()">V√ÄO H·ªÜ TH·ªêNG</button>
    </div>
</div>
<div id="class-screen" class="screen">
    <button onclick="showScreen('auth-screen')" style="background:none; border:none; color:var(--blue); font-weight:bold; cursor:pointer; margin-bottom:15px;">‚Üê QUAY L·∫†I</button>
    <div class="card">
        <h3 id="class-title">Ch·ªçn l·ªõp tr·ª±c</h3>
        <div class="class-grid" id="class-list-btns">
            </div>
    </div>
</div>

<div id="score-screen" class="screen">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
        <button onclick="showScreen('class-screen')" style="background:none; border:none; color:var(--blue); font-weight:bold; cursor:pointer;">‚Üê CH·ªåN L·ªöP KH√ÅC</button>
        <b id="display-info" style="color:var(--red); background:#fff; padding:5px 10px; border-radius:10px; font-size:14px;"></b>
    </div>

    <div class="card">
        <h3 style="margin-top:0; color:var(--blue);">Danh m·ª•c vi ph·∫°m</h3>
        <div id="criteria-container">
            </div>
    </div>

    <div class="card">
        <h3 style="margin-top:0;">L·ªãch s·ª≠ v·ª´a nh·∫≠p (T·∫°m th·ªùi)</h3>
        <div class="ls-table-container">
            <table class="ls-table">
                <thead>
                    <tr>
                        <th>L·ªõp</th>
                        <th>N·ªôi dung</th>
                        <th>HS/L·∫ßn</th>
                        <th>ƒêi·ªÉm</th>
                        <th>X√≥a</th>
                    </tr>
                </thead>
                <tbody id="ls-body"></tbody>
            </table>
        </div>
        <button class="btn-main" style="background:var(--green); margin-top:20px;" onclick="syncFinal()">L∆ØU & ƒê·ªíNG B·ªò TO√ÄN H·ªÜ TH·ªêNG</button>
    </div>
</div>

<script>
[cite_start]// D·ªÆ LI·ªÜU T·ª™ FILE WORD C·ª¶A B·∫†N [cite: 5]
const DATA_SD = [
    { group: "T√°c phong", items: [
        { n: "Kh√¥ng khƒÉn qu√†ng/Huy hi·ªáu", d: -5 },
        { n: "Kh√¥ng b·ªè √°o v√†o qu·∫ßn", d: -5 },
        { n: "M·∫∑c √°o kho√°c sai quy ƒë·ªãnh", d: -5 },
        { n: "ƒê·ªìng ph·ª•c sai quy ƒë·ªãnh", d: -5 },
        { n: "ƒêi ch√¢n tr·∫ßn", d: -5 },
        { n: "T√≥c d√†i (nam)", d: -5 },
        { n: "Nhu·ªôm t√≥c/Trang ƒëi·ªÉm", d: -10 }
    ]},
    { group: "K·ª∑ lu·∫≠t & Giao th√¥ng", items: [
        { n: "ƒê·ªÉ xe sai quy ƒë·ªãnh", d: -5 },
        { n: "Kh√¥ng ƒë·ªôi m≈© b·∫£o hi·ªÉm", d: -5 },
        { n: "Ra c·ªïng kh√¥ng xin ph√©p", d: -5 },
        { n: "S·ª≠ d·ª•ng ƒëi·ªán tho·∫°i sai n∆°i", d: -5 },
        { n: "Chui r√†o/Ph√° r√†o", d: -30 }
    ]},
    { group: "N·ªÅ n·∫øp & V·ªá sinh", items: [
        { n: "N√≥i t·ª•c/Ch·ª≠i th·ªÅ", d: -10 },
        { n: "ƒê√°nh nhau", d: -10 },
        { n: "ƒÇn u·ªëng sai quy ƒë·ªãnh", d: -10 },
        { n: "B·ªè r√°c sai n∆°i", d: -20 },
        { n: "V·∫Ω b·∫≠y t∆∞·ªùng/b√†n gh·∫ø", d: -10 },
        { n: "Ph√° ho·∫°i t√†i s·∫£n tr∆∞·ªùng", d: -30 }
    ]},
    { group: "Chuy√™n c·∫ßn & T·∫≠p th·ªÉ", items: [
        { n: "ƒêi tr·ªÖ", d: -2 },
        { n: "V·∫Øng kh√¥ng ph√©p", d: -5 },
        { n: "Tr·ªën ti·∫øt", d: -10 },
        { n: "N√≥i chuy·ªán ri√™ng", d: -5 },
        { n: "B·ªè SH 15 ph√∫t/TD gi·ªØa gi·ªù", d: -50 }
    ]},
    { group: "Nghi·ªáp v·ª• Sao ƒë·ªè", items: [
        { n: "Sƒê kh√¥ng bƒÉng/Tr·ª±c tr·ªÖ", d: -10 },
        { n: "Sƒê kh√¥ng ƒëi tr·ª±c", d: -20 },
        { n: "Sƒê kh√¥ng t·ªïng k·∫øt cu·ªëi tu·∫ßn", d: -50 },
        { n: "Sƒê bao che b·∫°n b√®", d: -100 }
    ]}
];

const DATA_GV = [
    { group: "S·ªï ƒë·∫ßu b√†i", items: [
        { n: "Ti·∫øt h·ªçc lo·∫°i A", d: 10 },
        { n: "Ti·∫øt h·ªçc lo·∫°i B", d: 5 },
        { n: "Ti·∫øt h·ªçc lo·∫°i C", d: -5 },
        { n: "Ti·∫øt h·ªçc lo·∫°i D", d: -10 },
        { n: "L√†m m·∫•t s·ªï ƒë·∫ßu b√†i", d: -50 }
    ]},
    { group: "H·ªçc t·∫≠p", items: [
        { n: "ƒêi·ªÉm 10", d: 10 },
        { n: "ƒêi·ªÉm 8, 9", d: 9 },
        { n: "ƒêi·ªÉm 7", d: 5 },
        { n: "ƒêi·ªÉm 4", d: -5 },
        { n: "ƒêi·ªÉm 0, 1, 2, 3", d: -10 },
        { n: "Kh√¥ng thu·ªôc/L√†m b√†i t·∫≠p", d: -10 }
    ]},
    { group: "Phong tr√†o & Kh√°c", items: [
        { n: "Nh·∫•t/Nh√¨/Ba phong tr√†o", d: 50 },
        { n: "Nh·∫∑t ƒë∆∞·ª£c c·ªßa r∆°i", d: 5 }
    ]}
];

const DS_GV = ["C√¥ Hu·ªá", "Th·∫ßy S∆°n", "C√¥ Lan", "Th·∫ßy H√πng", "Th·∫ßy ƒê·ª©c"];
const DS_SD = ["An 9A1", "B√¨nh 8A2", "Chi 7A1", "D≈©ng 6A2", "H·∫°nh 9A2"];
const DANH_SACH_LOP = ["6A1","6A2","6A3","7A1","7A2","8A1","8A2","9A1","9A2"];
</script>let currentRole = '', currentUser = '', currentLop = '', lsTemp = [];

// Kh·ªüi t·∫°o ·ª©ng d·ª•ng
function init(role) {
    currentRole = role;
    if(role === 'BXH') { renderBXH(); showScreen('bxh-screen'); return; }
    
    document.getElementById('auth-title').innerText = "ƒêƒÉng nh·∫≠p: " + (role === 'GV' ? 'GI√ÅO VI√äN' : 'SAO ƒê·ªé');
    document.getElementById('pin-input').style.display = (role === 'SD' ? 'block' : 'none');
    renderUserList();
    showScreen('auth-screen');
}

function renderUserList() {
    const list = currentRole === 'GV' ? DS_GV : DS_SD;
    let html = '';
    list.sort().forEach(name => {
        html += `<div class="user-item" onclick="selectUser(this)">${name}</div>`;
    });
    document.getElementById('user-list').innerHTML = html;
}

function selectUser(el) {
    document.querySelectorAll('.user-item').forEach(i => i.classList.remove('selected'));
    el.classList.add('selected');
    currentUser = el.innerText;
}

function verifyUser() {
    if(!currentUser) return alert("Vui l√≤ng ch·ªçn t√™n!");
    if(currentRole === 'SD' && document.getElementById('pin-input').value !== '1234') return alert("Sai m√£ PIN!");
    
    renderClassButtons();
    showScreen('class-screen');
}

function renderClassButtons() {
    let html = '';
    DANH_SACH_LOP.forEach(lop => {
        html += `<button class="btn-cl" onclick="selectLop('${lop}', this)">${lop}</button>`;
    });
    document.getElementById('class-list-btns').innerHTML = html;
}

function selectLop(lop, btn) {
    currentLop = lop;
    document.querySelectorAll('.btn-cl').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('display-info').innerText = `${lop} | Tr·ª±c: ${currentUser}`;
    renderCriteria();
    showScreen('score-screen');
}

function renderCriteria() {
    const data = currentRole === 'GV' ? DATA_GV : DATA_SD;
    let html = '';
    data.forEach((group, gIdx) => {
        html += `<h4 style="margin:15px 0 5px; color:#666; border-bottom:1px solid #ddd">${group.group}</h4>`;
        group.items.forEach((item, iIdx) => {
            const id = `item-${gIdx}-${iIdx}`;
            html += `
                <div class="item-row" onclick="toggleDetail('${id}')">
                    <span>${item.n}</span>
                    <b style="color:${item.d > 0 ? 'green' : 'red'}">${item.d > 0 ? '+'+item.d : item.d}</b>
                </div>
                <div class="detail-area" id="${id}">
                    <input type="text" id="hs-${id}" placeholder="T√™n h·ªçc sinh vi ph·∫°m...">
                    <input type="number" id="sl-${id}" value="1" min="1" placeholder="S·ªë l·∫ßn">
                    <button class="btn-main" style="padding:10px; background:var(--blue)" 
                        onclick="addToLS('${item.n}', ${item.d}, '${id}')">X√°c nh·∫≠n</button>
                </div>`;
        });
    });
    document.getElementById('criteria-container').innerHTML = html;
}

function toggleDetail(id) {
    const el = document.getElementById(id);
    const isOpen = el.style.display === 'flex';
    document.querySelectorAll('.detail-area').forEach(d => d.style.display = 'none');
    el.style.display = isOpen ? 'none' : 'flex';
}

function addToLS(name, score, id) {
    const hs = document.getElementById(`hs-${id}`).value || "C·∫£ l·ªõp";
    const sl = parseInt(document.getElementById(`sl-${id}`).value) || 1;
    
    const entry = {
        id: Date.now(),
        lop: currentLop,
        loi: name,
        info: hs,
        sl: sl,
        diem: score * sl,
        nguoi: currentUser,
        time: new Date().toLocaleString('vi-VN')
    };
    
    lsTemp.push(entry);
    renderLS();
    toggleDetail(id);
}

function renderLS() {
    let html = '';
    lsTemp.forEach((item, idx) => {
        html += `<tr>
            <td>${item.lop}</td>
            <td>${item.loi}</td>
            <td>${item.info} (x${item.sl})</td>
            <td>${item.diem}</td>
            <td><button class="btn-del" onclick="lsTemp.splice(${idx},1);renderLS()">X</button></td>
        </tr>`;
    });
    document.getElementById('ls-body').innerHTML = html;
}

// T·ª∞ ƒê·ªòNG SAO L∆ØU ƒê·ªíNG B·ªò (LocalStorage)
function syncFinal() {
    if(lsTemp.length === 0) return alert("Ch∆∞a c√≥ d·ªØ li·ªáu ƒë·ªÉ l∆∞u!");
    
    // L·∫•y d·ªØ li·ªáu c≈© t·ª´ b·ªô nh·ªõ
    let allData = JSON.parse(localStorage.getItem('PHUOCAN_DB')) || [];
    // G·ªôp d·ªØ li·ªáu m·ªõi v√†o
    allData = [...allData, ...lsTemp];
    // L∆∞u l·∫°i v√†o b·ªô nh·ªõ thi·∫øt b·ªã
    localStorage.setItem('PHUOCAN_DB', JSON.stringify(allData));
    
    alert("ƒê√£ ƒë·ªìng b·ªô th√†nh c√¥ng l√™n h·ªá th·ªëng!");
    lsTemp = [];
    renderLS();
    goHome();
}

function renderBXH() {
    const db = JSON.parse(localStorage.getItem('PHUOCAN_DB')) || [];
    let bxh = {};
    DANH_SACH_LOP.forEach(l => bxh[l] = 100); // ƒêi·ªÉm g·ªëc l√† 100

    db.forEach(entry => {
        if(bxh[entry.lop] !== undefined) bxh[entry.lop] += entry.diem;
    });

    let sorted = Object.entries(bxh).sort((a, b) => b[1] - a[1]);
    let html = '';
    sorted.forEach((item, idx) => {
        html += `
            <div class="rank-row ${idx === 0 ? 'rank-1' : ''}">
                <div style="font-size:2rem; width:60px">${idx + 1}</div>
                <div style="flex:1; text-align:left; font-size:1.5rem">L·ªõp ${item[0]}</div>
                <div style="font-size:1.8rem">${item[1]} ƒë</div>
            </div>`;
    });
    document.getElementById('bxh-content').innerHTML = html || "<p>Ch∆∞a c√≥ d·ªØ li·ªáu thi ƒëua</p>";
}

function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
    document.getElementById(id).style.display = 'block';
    window.scrollTo(0,0);
}

function goHome() {
    showScreen('home-screen');
    currentUser = '';
    currentLop = '';
    lsTemp = [];
}
</script>

<div id="bxh-screen" class="screen">
    <h1 style="color:var(--orange); font-size:2.5rem; margin-bottom:5px">üèÜ B·∫¢NG V√ÄNG THI ƒêUA</h1>
    <p id="bxh-week-title">H·ªåC K·ª≤ 2 - NƒÇM H·ªåC 2025-2026</p>
    <div id="bxh-content"></div>
    <button class="btn-main" style="background:#444; margin-top:30px" onclick="goHome()">THO√ÅT</button>
</div>

</body>
</html>
