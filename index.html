<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAO Äá» PHÆ¯á»šC AN</title>

<style>
:root{
  --p:#2563eb; --s:#16a34a; --a:#dc2626;
  --bg:#f1f5f9; --card:#ffffff;
}
*{box-sizing:border-box}
body{margin:0;padding:10px;font-family:system-ui,Arial;background:var(--bg)}

#login-screen{
  position:fixed; inset:0;
  background:linear-gradient(135deg,#2563eb,#38bdf8);
  display:flex; flex-direction:column;
  justify-content:center; align-items:center;
  color:white; z-index:999;
}
.pin-input{
  width:180px; padding:14px;
  font-size:2rem; text-align:center;
  border:none; border-radius:14px;
  letter-spacing:6px;
}

.card{
  background:var(--card);
  border-radius:16px;
  padding:14px; margin-bottom:14px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}

.bxh-table{width:100%;border-collapse:collapse}
.bxh-table th,.bxh-table td{padding:10px;border-bottom:1px solid #eee}

.search-box{
  width:100%; padding:10px;
  border-radius:10px; border:1px solid #ccc;
  margin-bottom:10px;
}

.entry-table{width:100%;border-collapse:collapse;font-size:.8rem}
.entry-table th{background:#f8fafc;padding:8px;border:1px solid #ddd}
.entry-table td{border:1px solid #ddd;padding:5px}

.input-name{width:100%;padding:6px;border-radius:6px;border:1px solid #ccc}
.input-qty{width:45px;padding:6px;border-radius:6px;border:1px solid #ccc;text-align:center}

.res-table{width:100%;border-collapse:collapse;font-size:.75rem;margin-top:10px}
.res-table th,.res-table td{border:1px solid #333;padding:6px}

.btn-confirm{
  width:100%; padding:14px;
  border:none; border-radius:12px;
  background:linear-gradient(135deg,#2563eb,#38bdf8);
  color:white; font-weight:bold;
}

.minus{color:var(--a);font-weight:700}
.plus{color:var(--s);font-weight:700}
</style>
</head>

<body>

<div id="login-screen">
  <h2>ğŸ” Máº¬T MÃƒ SAO Äá»</h2>
  <input type="password" id="pin-input" class="pin-input" placeholder="â€¢â€¢â€¢â€¢" maxlength="4" oninput="checkPin()">
</div>

<div id="main-content" style="display:none">

<div class="card">
<h3>ğŸ† Báº¢NG Xáº¾P Háº NG</h3>
<table class="bxh-table">
<thead><tr><th>Háº¡ng</th><th>Lá»›p</th><th>Äiá»ƒm</th></tr></thead>
<tbody id="bxh-body"></tbody>
</table>
</div>

<div id="input-area" class="card" style="display:none">

<h3 id="current-lop-label" style="text-align:center"></h3>

<input class="search-box" id="search-loi" placeholder="ğŸ” TÃ¬m lá»—i..." onkeyup="filterLoi()">

<div style="overflow-x:auto">
<table class="entry-table">
<thead>
<tr><th>Ná»™i dung</th><th>Äiá»ƒm</th><th>TÃªn HS</th><th>SL</th></tr>
</thead>
<tbody id="error-list-body"></tbody>
</table>
</div>

<button class="btn-confirm" onclick="updateFinalTable()">ğŸ’¾ XÃC NHáº¬N</button>

<h4>ğŸ“Š CHI TIáº¾T</h4>
<table class="res-table">
<thead>
<tr><th>Ná»™i dung</th><th>Äiá»ƒm</th><th>HS</th><th>SL</th><th>Tá»•ng</th></tr>
</thead>
<tbody id="res-body"></tbody>
<tr>
<td colspan="4" style="text-align:right">Tá»•ng:</td>
<td id="total-val">0</td>
</tr>
</table>

<button onclick="resetLopData()" style="margin-top:10px;color:red">XÃ³a lá»›p nÃ y</button>

</div>
</div>

<script>
const PIN="1234";
const LOP_LIST=['6A1','6A2','6A3','7A1','7A2','8A1','8A2','9A1','9A2'];

const ALL_ERRORS=[
// TÃC PHONG
{n:"KhÃ´ng Ä‘eo khÄƒn quÃ ng / huy hiá»‡u",d:-5},
{n:"KhÃ´ng bá» Ã¡o vÃ o quáº§n",d:-5},
{n:"Máº·c Ã¡o khoÃ¡c trong trÆ°á»ng",d:-5},
{n:"Sai Ä‘á»“ng phá»¥c",d:-5},
{n:"Äi chÃ¢n tráº§n",d:-5},
{n:"Äá»ƒ xe khÃ´ng ngay hÃ ng",d:-5},
{n:"KhÃ´ng Ä‘á»™i mÅ© báº£o hiá»ƒm",d:-5},
{n:"Ra khá»i cá»•ng khÃ´ng xin phÃ©p",d:-5},
{n:"DÃ¹ng Ä‘iá»‡n thoáº¡i sai quy Ä‘á»‹nh",d:-5},
{n:"TÃ³c dÃ i (nam)",d:-5},
{n:"Nhuá»™m tÃ³c / trang Ä‘iá»ƒm",d:-10},

// HÃ€NH VI
{n:"NÃ³i tá»¥c, chá»­i thá»",d:-10},
{n:"ÄÃ¡nh nhau",d:-10},
{n:"Chá»‘ng Ä‘á»‘i sao Ä‘á»",d:-10},

// CHUYÃŠN Cáº¦N
{n:"Äi trá»…",d:-2},
{n:"Váº¯ng khÃ´ng phÃ©p",d:-5},
{n:"Trá»‘n tiáº¿t",d:-10},

// Há»ŒC Táº¬P
{n:"NÃ³i chuyá»‡n riÃªng",d:-5},
{n:"KhÃ´ng sinh hoáº¡t Ä‘áº§u giá»",d:-5},
{n:"KhÃ´ng thuá»™c bÃ i",d:-10},
{n:"KhÃ´ng lÃ m bÃ i táº­p",d:-10},
{n:"KhÃ´ng chuáº©n bá»‹ bÃ i",d:-10},
{n:"Máº¥t bÃ i kiá»ƒm tra",d:-20},

// ÄIá»‚M
{n:"Äiá»ƒm 0â€“3",d:-10},
{n:"Äiá»ƒm 4",d:-5},
{n:"Äiá»ƒm 7",d:5},
{n:"Äiá»ƒm 8â€“9",d:9},
{n:"Äiá»ƒm 10",d:10},

// TIáº¾T
{n:"Tiáº¿t loáº¡i A",d:10},
{n:"Tiáº¿t loáº¡i B",d:5},
{n:"Tiáº¿t loáº¡i C",d:-5},
{n:"Tiáº¿t loáº¡i D",d:-10},

// VIá»†C Tá»T
{n:"Nháº·t cá»§a rÆ¡i tráº£ láº¡i",d:5},

// SAO Äá»
{n:"KhÃ´ng Ä‘eo bÄƒng sao Ä‘á»",d:-10},
{n:"Sao Ä‘á» Ä‘i trá»±c trá»…",d:-10},
{n:"Sao Ä‘á» khÃ´ng Ä‘i trá»±c",d:-20},
{n:"KhÃ´ng tá»•ng káº¿t tuáº§n",d:-50},
];

let db=JSON.parse(localStorage.getItem("SAODO_DB"))||{};
let curLop="";

function checkPin(){
 let v=pin-input.value;
 if(v===PIN){
  login-screen.style.display="none";
  main-content.style.display="block";
  renderBXH();
 }else if(v.length===4){alert("Sai PIN");pin-input.value="";}
}

function init(){
 LOP_LIST.forEach(l=>{if(!db[l])db[l]={total:100,logs:[]};});
 const body=error-list-body;
 ALL_ERRORS.forEach(it=>{
  const id=Math.random().toString(36).slice(2,7);
  body.innerHTML+=`
<tr class="loi-row-item" data-search="${it.n.toLowerCase()}">
<td>${it.n
