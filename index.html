<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SAO ƒê·ªé PH∆Ø·ªöC AN - 2026</title>
    <style>
        :root { --p: #4361ee; --s: #2ec4b6; --a: #e71d36; --bg: #f4f7fe; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; }
        
        /* M√†n h√¨nh PIN */
        #lock-screen { position: fixed; inset: 0; background: var(--p); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; color: white; }
        .pin-box input { width: 120px; padding: 15px; text-align: center; font-size: 2rem; border-radius: 15px; border: none; color: var(--p); font-weight: bold; }

        .header { text-align: center; padding: 15px; background: linear-gradient(135deg, var(--p), #7209b7); color: white; border-radius: 15px; margin-bottom: 15px; }

        /* B·∫¢NG X·∫æP H·∫†NG (M·ªöI) */
        .xh-container { background: white; padding: 15px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 15px; }
        .xh-title { font-weight: bold; color: var(--p); margin-bottom: 10px; display: block; text-align: center; border-bottom: 2px solid #eee; padding-bottom: 5px; }
        .grid-xh { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; }
        .lop-card { background: #fff; padding: 12px 5px; border-radius: 15px; text-align: center; cursor: pointer; border: 2px solid #eee; transition: 0.2s; position: relative; }
        .lop-card.active { border-color: var(--p); background: #edf2ff; transform: scale(1.05); }
        .lop-card b { display: block; font-size: 1.1rem; }
        .lop-card span { font-size: 0.85rem; color: var(--p); font-weight: bold; }
        .rank-icon { position: absolute; top: -5px; right: -5px; font-size: 1.2rem; }

        /* V√ôNG CH·∫§M ƒêI·ªÇM */
        .main-card { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); display: none; margin-top: 10px; }
        input[type="text"] { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #ddd; font-size: 1rem; box-sizing: border-box; margin: 10px 0; outline: none; }
        
        .scroll-loi { max-height: 400px; overflow-y: auto; margin-bottom: 15px; }
        .loi-item { display: flex; align-items: center; background: #f9f9f9; padding: 12px; border-radius: 12px; margin-bottom: 8px; cursor: pointer; border: 1px solid #eee; }
        .loi-item input { width: 22px; height: 22px; margin-right: 15px; pointer-events: none; }
        .loi-item span { flex: 1; font-size: 0.95rem; }
        .loi-item b { color: var(--a); }

        .btn-save { width: 100%; padding: 18px; border-radius: 15px; border: none; background: var(--p); color: white; font-size: 1.1rem; font-weight: bold; cursor: pointer; }

        /* NH·∫¨T K√ù */
        .log-box { margin-top: 20px; background: #fffde7; padding: 15px; border-radius: 15px; border: 1px dashed #fbc02d; font-size: 0.85rem; }
        .log-item { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 8px 0; align-items: center; }
        .btn-del { background: #ffebee; color: red; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer; font-weight: bold; }

        .footer { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .btn-foot { padding: 12px; border-radius: 12px; border: none; color: white; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div id="lock-screen">
    <h3 style="margin-bottom:20px">üîë PIN SAO ƒê·ªé</h3>
    <input type="password" maxlength="4" id="pin" oninput="if(this.value==='1234'){document.getElementById('lock-screen').style.display='none';document.getElementById('app').style.display='block';render();}">
</div>

<div id="app" style="display:none">
    <div class="header"><h2>üåü SAO ƒê·ªé PH∆Ø·ªöC AN</h2></div>

    <div class="xh-container">
        <span class="xh-title">B·∫¢NG X·∫æP H·∫†NG THI ƒêUA</span>
        <div class="grid-xh" id="grid-lops"></div>
    </div>

    <div class="main-card" id="vung-cham">
        <h3 id="lbl-lop" style="margin:0; color:var(--p)">L·ªõp --</h3>
        <input type="text" id="txt-ten" placeholder="Nh·∫≠p t√™n HS (v√≠ d·ª•: An, B√¨nh, Chi)...">
        
        <div class="scroll-loi">
            <div style="font-size:0.7rem; color:#999; margin:10px 0">T√ÅC PHONG (-5ƒë)</div>
            <div class="loi-item" onclick="toggle('l1')"><input type="checkbox" id="l1" data-d="-5" data-n="KhƒÉn qu√†ng"> <span>Kh√¥ng khƒÉn qu√†ng/Huy hi·ªáu</span> <b>-5</b></div>
            <div class="loi-item" onclick="toggle('l2')"><input type="checkbox" id="l2" data-d="-5" data-n="B·ªè √°o ngo√†i"> <span>Kh√¥ng b·ªè √°o v√†o qu·∫ßn</span> <b>-5</b></div>
            
            <div style="font-size:0.7rem; color:#999; margin:10px 0">K·ª∂ LU·∫¨T & CHUY√äN C·∫¶N</div>
            <div class="loi-item" onclick="toggle('l3')"><input type="checkbox" id="l3" data-d="-2" data-n="ƒêi tr·ªÖ"> <span>H·ªçc sinh ƒëi tr·ªÖ</span> <b>-2</b></div>
            <div class="loi-item" onclick="toggle('l4')"><input type="checkbox" id="l4" data-d="-10" data-n="N√≥i t·ª•c"> <span>N√≥i t·ª•c, ch·ª≠i th·ªÅ</span> <b>-10</b></div>
            <div class="loi-item" onclick="toggle('l5')"><input type="checkbox" id="l5" data-d="-50" data-n="SH 15p" data-type="L"> <span>L·ªõp kh√¥ng SH 15 ph√∫t</span> <b>-50</b></div>

            <div style="font-size:0.7rem; color:#999; margin:10px 0">TH∆Ø·ªûNG (+)</div>
            <div class="loi-item" onclick="toggle('l6')"><input type="checkbox" id="l6" data-d="10" data-n="ƒêi·ªÉm 10"> <span>ƒê·∫°t ƒëi·ªÉm 10</span> <b style="color:var(--s)">+10</b></div>
        </div>

        <button class="btn-save" onclick="luu()">X√ÅC NH·∫¨N & L√ÄM ƒê·ª¢T M·ªöI</button>

        <div class="log-box">
            <b>Nh·∫≠t k√Ω & ƒêi·ªÅu ch·ªânh:</b>
            <div id="list-logs"></div>
        </div>
    </div>

    <div class="footer">
        <button class="btn-foot" style="background:#0068ff" onclick="xuat()">üìã COPY ZALO</button>
        <button class="btn-foot" style="background:#6c757d" onclick="if(confirm('X√≥a h·∫øt d·ªØ li·ªáu?')) {localStorage.clear(); location.reload();}">üîÑ RESET</button>
    </div>
</div>

<script>
    const lops = ['6A','6B','6C','7A','7B','7C','8A','8B','8C','9A','9B'];
    let db = JSON.parse(localStorage.getItem('pa_2026_vfinal')) || {};
    let cur = "";

    function render() {
        const sorted = [...lops].sort((a,b) => (db[b]?.total||100) - (db[a]?.total||100));
        let html = "";
        sorted.forEach((l, i) => {
            let s = db[l] ? db[l].total : 100;
            let medal = i===0 ? 'ü•á' : i===1 ? 'ü•à' : i===2 ? 'ü•â' : '';
            html += `<div class="lop-card ${cur===l?'active':''}" onclick="chonLop('${l}')">
                        <div class="rank-icon">${medal}</div>
                        <b>${l}</b><span>${s}ƒë</span>
                    </div>`;
        });
        document.getElementById('grid-lops').innerHTML = html;
    }

    function chonLop(l) {
        cur = l; render();
        document.getElementById('vung-cham').style.display = 'block';
        document.getElementById('lbl-lop').innerText = "CH·∫§M L·ªöP " + l;
        renderLogs();
    }

    function toggle(id) { document.getElementById(id).checked = !document.getElementById(id).checked; }

    function luu() {
        const txt = document.getElementById('txt-ten').value.trim();
        const hs = txt.split(/[,.;]+/).filter(x => x.trim().length > 0);
        const cks = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'));

        if(cks.length === 0) return alert("Ch∆∞a ch·ªçn l·ªói!");
        if(cks.some(c => !c.dataset.type) && hs.length === 0) return alert("Ch∆∞a nh·∫≠p t√™n HS!");

        if(!db[cur]) db[cur] = { total: 100, logs: [] };

        cks.forEach(c => {
            let d = parseInt(c.dataset.d);
            let n = c.dataset.type === "L" ? 1 : hs.length;
            let sum = d * n;
            db[cur].total += sum;
            db[cur].logs.unshift({ id: Date.now()+Math.random(), time: new Date().toLocaleTimeString('vi-VN',{hour:'2-digit',minute:'2-digit'}), info: `${txt||'L·ªõp'} - ${c.dataset.n}`, score: sum });
        });

        document.getElementById('txt-ten').value = "";
        cks.forEach(c => c.checked = false);
        localStorage.setItem('pa_2026_vfinal', JSON.stringify(db));
        render(); renderLogs();
    }

    function renderLogs() {
        const box = document.getElementById('list-logs');
        if(!db[cur] || db[cur].logs.length === 0) { box.innerHTML = "<small>Ch∆∞a c√≥ d·ªØ li·ªáu.</small>"; return; }
        box.innerHTML = db[cur].logs.map(i => `
            <div class="log-item">
                <span>${i.time} | ${i.info} (<b>${i.score>0?'+'+i.score:i.score}</b>)</span>
                <button class="btn-del" onclick="xoaLog(${i.id}, ${i.score})">X√≥a</button>
            </div>
        `).join("");
    }

    function xoaLog(id, score) {
        if(!confirm("X√≥a l·ªói n√†y v√† tr·∫£ l·∫°i ƒëi·ªÉm?")) return;
        db[cur].total -= score;
        db[cur].logs = db[cur].logs.filter(i => i.id !== id);
        localStorage.setItem('pa_2026_vfinal', JSON.stringify(db));
        render(); renderLogs();
    }

    function xuat() {
        let msg = "üìä B√ÅO C√ÅO THI ƒêUA PH∆Ø·ªöC AN\n";
        [...lops].sort((a,b) => (db[b]?.total||100) - (db[a]?.total||100)).forEach((l, i) => {
            msg += `${i+1}. L·ªõp ${l}: ${db[l]?.total || 100}ƒë\n`;
        });
        navigator.clipboard.writeText(msg).then(() => alert("ƒê√£ copy b√°o c√°o!"));
    }
</script>
</body>
</html>
