<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>H·ªá Th·ªëng ƒêi·ªÉm Sao ƒê·ªè</title>

<style>
  body { font-family: 'Segoe UI', Arial, sans-serif; background: #e8f4ff; margin: 0; padding: 15px; }
  h1 { text-align: center; color: #1976d2; text-transform: uppercase; }
  
  .container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
  
  /* B·∫£ng x·∫øp h·∫°ng */
  .table-container { flex: 1; min-width: 350px; }
  table { border-collapse: collapse; width: 100%; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
  th, td { border: 1px solid #eee; padding: 12px; text-align: center; }
  th { background: #1976d2; color: white; }
  
  .lop-row { cursor: pointer; transition: 0.3s; }
  .lop-row:hover { background: #e3f2fd; }
  .dang-chon { background: #fff9c4 !important; border: 2px solid #fbc02d; }
  
  /* B·∫£ng nh·∫≠p l·ªói */
  #panel { width: 320px; background: #ffffff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: none; }
  #panel h3 { text-align: center; color: #d32f2f; margin-top: 0; }
  input[type=number] { width: 50px; padding: 5px; border: 1px solid #ccc; border-radius: 4px; }
  
  .btn-group { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
  button { padding: 10px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; }
  .btn-apply { background: #2e7d32; color: white; }
  .btn-report { background: #1976d2; color: white; margin-top: 20px; width: 100%; }
</style>
</head>

<body>

<h1>B·∫¢NG ƒêI·ªÇM SAO ƒê·ªé</h1>

<div class="container">
  <div class="table-container">
    <table id="bang">
      <thead>
        <tr>
          <th>L·ªõp</th>
          <th>T·ªïng ƒëi·ªÉm</th>
          <th>X·∫øp h·∫°ng</th>
        </tr>
      </thead>
      <tbody id="body-bang">
        <tr class="lop-row" data-lop="6A" onclick="chonLop(this)"><td>6A</td><td class="tong">100</td><td class="xephang"></td></tr>
        <tr class="lop-row" data-lop="6B" onclick="chonLop(this)"><td>6B</td><td class="tong">100</td><td class="xephang"></td></tr>
        <tr class="lop-row" data-lop="6C" onclick="chonLop(this)"><td>6C</td><td class="tong">100</td><td class="xephang"></td></tr>
        <tr class="lop-row" data-lop="7A" onclick="chonLop(this)"><td>7B</td><td class="tong">100</td><td class="xephang"></td></tr>
        <tr class="lop-row" data-lop="7B" onclick="chonLop(this)"><td>7B</td><td class="tong">100</td><td class="xephang"></td></tr>
        <tr class="lop-row" data-lop="7C" onclick="chonLop(this)"><td>7C</td><td class="tong">100</td><td class="xephang"></td></tr>
      <tr class="lop-row" data-lop="8A" onclick="chonLop(this)"><td>8A</td><td class="tong">100</td><td class="xephang"></td></tr>
      <tr class="lop-row" data-lop="8B" onclick="chonLop(this)"><td>8B</td><td class="tong">100</td><td class="xephang"></td></tr>
      <tr class="lop-row" data-lop="8C" onclick="chonLop(this)"><td>8C</td><td class="tong">100</td><td class="xephang"></td></tr>
      <tr class="lop-row" data-lop="9A" onclick="chonLop(this)"><td>9A</td><td class="tong">100</td><td class="xephang"></td></tr>
      <tr class="lop-row" data-lop="9B" onclick="chonLop(this)"><td>9B</td><td class="tong">100</td><td class="xephang"></td></tr>
      </tbody>
    </table>
    <button class="btn-report" onclick="xuatBaoCao()">Sao ch√©p b√°o c√°o g·ª≠i Zalo</button>
  </div>

  <div id="panel">
    <h3 id="tenlop">Ch·ªçn m·ªôt l·ªõp</h3>
    <table>
      <tr><th>L·ªói vi ph·∫°m</th><th>S·ªë l·∫ßn</th></tr>
      <tr><td>ƒêi h·ªçc mu·ªôn (-2)</td><td><input type="number" min="0" data-diem="2" class="input-loi"></td></tr>
      <tr><td>ƒê·ªìng ph·ª•c (-5)</td><td><input type="number" min="0" data-diem="5" class="input-loi"></td></tr>
      <tr><td>KhƒÉn qu√†ng (-3)</td><td><input type="number" min="0" data-diem="3" class="input-loi"></td></tr>
      <tr><td>·ªín √†o (-2)</td><td><input type="number" min="0" data-diem="2" class="input-loi"></td></tr>
    </table>
    <div class="btn-group">
      <button class="btn-apply" onclick="apDung()">C·∫≠p nh·∫≠t ƒëi·ªÉm</button>
    </div>
  </div>
</div>

<script>
let lopDangChon = null;

// T·ª± ƒë·ªông load d·ªØ li·ªáu c≈© khi m·ªü trang
window.onload = () => {
  const savedData = localStorage.getItem('dataSaoDo');
  if (savedData) {
    const scores = JSON.parse(savedData);
    document.querySelectorAll(".lop-row").forEach(r => {
      if(scores[r.dataset.lop]) {
        r.querySelector(".tong").innerText = scores[r.dataset.lop];
        r.dataset.tong = scores[r.dataset.lop];
      }
    });
  }
  xepHang();
};

function chonLop(row) {
  document.querySelectorAll(".lop-row").forEach(r => r.classList.remove("dang-chon"));
  row.classList.add("dang-chon");
  
  lopDangChon = row;
  document.getElementById("panel").style.display = "block";
  document.getElementById("tenlop").innerText = "Ch·∫•m ƒëi·ªÉm L·ªõp " + row.dataset.lop;
  document.querySelectorAll(".input-loi").forEach(i => i.value = 0);
  
  // Cu·ªôn xu·ªëng b·∫£ng nh·∫≠p n·∫øu d√πng ƒëi·ªán tho·∫°i
  if(window.innerWidth < 600) document.getElementById("panel").scrollIntoView({behavior: "smooth"});
}

function apDung() {
  if(!lopDangChon) return;
  
  let tongTru = 0;
  document.querySelectorAll(".input-loi").forEach(i => {
    tongTru += (Number(i.value) || 0) * Number(i.dataset.diem);
  });

  let diemMoi = 100 - tongTru;
  if (diemMoi < 0) diemMoi = 0;

  lopDangChon.querySelector(".tong").innerText = diemMoi;
  lopDangChon.dataset.tong = diemMoi;

  xepHang();
  luuDuLieu();
}

function xepHang() {
  let rows = Array.from(document.querySelectorAll(".lop-row"));
  rows.sort((a,b) => (Number(b.dataset.tong) || 100) - (Number(a.dataset.tong) || 100));

  let container = document.getElementById("body-bang");
  rows.forEach((r, i) => {
    let h = i + 1;
    let icon = h;
    if(h==1) icon="ü•á";
    if(h==2) icon="ü•à";
    if(h==3) icon="ü•â";
    r.querySelector(".xephang").innerText = icon;
    container.appendChild(r); // S·∫Øp x·∫øp l·∫°i th·ª© t·ª± h√†ng trong b·∫£ng
  });
}


  });
}
</script>

</body>
</html>
