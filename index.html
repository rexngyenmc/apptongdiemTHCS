<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ƒê·ªìng B·ªô Thi ƒêua Ph∆∞·ªõc An</title>
    <style>
        :root { --blue: #1a73e8; --green: #34a853; --orange: #fbbc05; --red: #ea4335; --dark: #202124; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; background: #f1f3f4; color: var(--dark); }
        
        /* Giao di·ªán ch√≠nh */
        #home-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; gap: 20px; padding: 20px; box-sizing: border-box; }
        .btn-main { width: 100%; max-width: 400px; padding: 25px; border: none; border-radius: 15px; color: white; font-size: 1.3rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .bg-gv { background: var(--blue); } .bg-sd { background: var(--green); } .bg-bxh { background: var(--orange); color: #000; }

        /* Ch·ªçn l·ªõp h√†ng ngang */
        .class-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
        .btn-cl { padding: 15px 5px; border: 1.5px solid #ddd; border-radius: 10px; background: #fff; font-weight: bold; cursor: pointer; }

        /* B·∫£ng x·∫øp h·∫°ng Tr√¨nh chi·∫øu r·ª±c r·ª° */
        #bxh-view { display: none; background: radial-gradient(circle, #001f3f, #000); min-height: 100vh; color: #fff; padding: 30px 15px; text-align: center; }
        .rank-row { display: flex; align-items: center; background: rgba(255,255,255,0.1); margin: 10px auto; padding: 18px; border-radius: 15px; max-width: 800px; border: 1px solid rgba(255,255,255,0.1); }
        .rank-1 { background: linear-gradient(90deg, #ffd700, #ff8f00) !important; color: #000 !important; transform: scale(1.05); border: 2px solid gold; }
    </style>
</head>
<body>

<div id="home-screen">
    <h1 style="margin-bottom: 5px;">THCS PH∆Ø·ªöC AN</h1>
    <p style="color: #666; margin-top: 0;">D·ªØ li·ªáu ƒë·ªìng b·ªô th·ªùi gian th·ª±c</p>
    <button class="btn-main bg-gv" onclick="init('GV')">T√îI L√Ä GI√ÅO VI√äN</button>
    <button class="btn-main bg-sd" onclick="init('SD')">T√îI L√Ä SAO ƒê·ªé</button>
    <button class="btn-main bg-bxh" onclick="init('BXH')">BXH TR√åNH CHI·∫æU</button>
</div>

<div id="app-container" style="display:none; padding: 20px; max-width: 600px; margin: auto;">
    <button onclick="location.reload()" style="padding: 10px; cursor: pointer;">‚Üê QUAY L·∫†I</button>
    <div id="auth-area" style="margin-top: 20px; background: white; padding: 20px; border-radius: 15px;">
        <h3 id="role-text"></h3>
        <input type="text" id="user-name" placeholder="Nh·∫≠p t√™n Gi√°o vi√™n/Sao ƒë·ªè..." style="width:100%; padding:12px; margin-bottom:10px;">
        <input type="password" id="pin-code" placeholder="Nh·∫≠p m√£ PIN..." style="width:100%; padding:12px; display:none;">
        <button class="btn-main bg-gv" style="padding: 15px;" onclick="verify()">TI·∫æP T·ª§C</button>
    </div>

    <div id="class-area" style="display:none; margin-top: 20px;">
        <h3>CH·ªåN L·ªöP (THEO H√ÄNG)</h3>
        <div class="class-grid" id="class-list"></div>
    </div>

    <div id="score-area" style="display:none; margin-top: 20px;">
        <h2 id="target-title" style="color:var(--blue)"></h2>
        <div id="criteria-list" style="text-align: left;"></div>
        <button class="btn-main bg-gv" style="width:100%; margin-top: 20px;" onclick="sendData()">L∆ØU & ƒê·ªíNG B·ªò</button>
    </div>
</div>

<div id="bxh-view">
    <h1 style="color: var(--orange); font-size: 2.5rem;">üèÜ B·∫¢NG V√ÄNG THI ƒêUA</h1>
    <p id="bxh-date" style="font-size: 1.2rem;"></p>
    <div id="bxh-content">ƒêang t·∫£i d·ªØ li·ªáu ƒë·ªìng b·ªô...</div>
    <button class="btn-main" style="background:#444; margin-top:30px; width: 200px;" onclick="location.reload()">THO√ÅT</button>
</div>

<script>
    const SCRIPT_URL = "https://rexngyenmc.github.io/apptongdiemTHCS/"; 
    const LOP = ["6A1","6A2","6A3","7A1","7A2","8A1","8A2","9A1","9A2"];
    let role = "", user = "", selectedLop = "";

    // D·ªØ li·ªáu ƒë√∫ng bi·ªÉu ƒëi·ªÉm tr∆∞·ªùng Ph∆∞·ªõc An 
    const DATA_GV = [
        {h: "H·ªçc t·∫≠p", ds: [{n:"1 ti·∫øt A", d:10}, {n:"1 ti·∫øt B", d:5}, {n:"ƒêi·ªÉm 10", d:10}, {n:"ƒêi·ªÉm 8,9", d:9}, {n:"Kh√¥ng b√†i t·∫≠p", d:-10}]}
    ];
    const DATA_SD = [
        {h: "T√°c phong", ds: [{n:"Kh√¥ng khƒÉn qu√†ng", d:-5}, {n:"Kh√¥ng √°o trong qu·∫ßn", d:-5}, {n:"ƒêi tr·ªÖ", d:-2}, {n:"N√≥i t·ª•c", d:-10}]}
    ];

    function init(r) {
        role = r;
        document.getElementById('home-screen').style.display = 'none';
        if(r === 'BXH') { verify(); return; }
        document.getElementById('app-container').style.display = 'block';
        document.getElementById('role-text').innerText = r === 'GV' ? "GI√ÅO VI√äN ƒêƒÇNG NH·∫¨P" : "SAO ƒê·ªé ƒêƒÇNG NH·∫¨P";
        if(r === 'SD') document.getElementById('pin-code').style.display = 'block';
    }

    function verify() {
        user = document.getElementById('user-name').value;
        const pin = document.getElementById('pin-code').value;
        if(role === 'SD' && pin !== '1234') { alert("Sai m√£ PIN Sao ƒë·ªè!"); return; }
        if(role === 'BXH') { showBXH(); return; }
        if(!user) { alert("Vui l√≤ng nh·∫≠p t√™n!"); return; }
        
        document.getElementById('auth-area').style.display = 'none';
        document.getElementById('class-area').style.display = 'block';
        const list = document.getElementById('class-list');
        list.innerHTML = "";
        LOP.forEach(l => list.innerHTML += `<button class="btn-cl" onclick="showScore('${l}')">${l}</button>`);
    }

    function showScore(l) {
        selectedLop = l;
        document.getElementById('class-area').style.display = 'none';
        document.getElementById('score-area').style.display = 'block';
        document.getElementById('target-title').innerText = "L·ªõp: " + l;
        const list = document.getElementById('criteria-list');
        const items = role === 'GV' ? DATA_GV : DATA_SD;
        list.innerHTML = "";
        items.forEach(g => {
            list.innerHTML += `<h4 style="border-bottom:2px solid #eee;">${g.h}</h4>`;
            g.ds.forEach(i => {
                list.innerHTML += `<div style="background:white; padding:12px; margin-bottom:5px; border-radius:8px; display:flex; justify-content:space-between;">
                    <span>${i.n} <b>(${i.d > 0 ? '+'+i.d : i.d})</b></span>
                    <input type="checkbox" class="chk" data-n="${i.n}" data-d="${i.d}">
                </div>`;
            });
        });
    }

    async function sendData() {
        const chks = document.querySelectorAll('.chk:checked');
        if(chks.length === 0) return alert("Ch∆∞a ch·ªçn m·ª•c n√†o!");
        const date = new Date().toLocaleDateString('vi-VN');
        
        alert("ƒêang ƒë·ªìng b·ªô ƒëi·ªÉm cho l·ªõp " + selectedLop + " ng√†y " + date);
        // Logic fetch(SCRIPT_URL, ...) s·∫Ω g·ª≠i k√®m: date, selectedLop, user, role
        location.reload();
    }

    function showBXH() {
        document.getElementById('bxh-view').style.display = 'block';
        document.getElementById('bxh-date').innerText = "Ng√†y: " + new Date().toLocaleDateString('vi-VN');
        // Logic hi·ªÉn th·ªã danh s√°ch l·ªõp t·ª´ cao ƒë·∫øn th·∫•p 
    }
</script>
</body>
</html>
